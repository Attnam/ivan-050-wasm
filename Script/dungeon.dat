Dungeons=2;
Teams=8;

/*
 * Description of teams:
 * 0 - Player and pets
 * 1 - Monsters, default relation to other teams == hostile
 * 3 - Petrus's team during the Final Battle
 */

Team 2; /* Residents of Attnam */
{
	Relation 0, FRIEND;
	AttackEvilness=250;
}

Team 4; /* Enner Beasts */
{
	Relation 0, HOSTILE;
	Relation 2, HOSTILE;
	Relation 3, HOSTILE;
}

Team 5; /* Spawned hostile angels */
{
	Relation 0, HOSTILE;
	Relation 1, UNCARING;
	Relation 4, HOSTILE;
}

Team 6; /* Dungeon shopkeepers */
{
	Relation 1, UNCARING;
	Relation 4, HOSTILE;
	AttackEvilness=100;
}

Team 7; /* Ivan */
{
	Relation 4, HOSTILE;
	AttackEvilness=100;
}

Dungeon 0;
{
	Levels=10;

	LevelDefault
	{
		FillSquare=solidterrain(GROUND),wall(EARTH);

		Variable XSize = 64;
		Variable YSize = 36;

		Size=XSize, YSize;
		Rooms=10+rand%21;
		Items=10+rand%21;
		GenerateMonsters=true;
		ReCalculate=true;
		GenerateUpStairs=true;
		GenerateDownStairs=true;
		OnGround=false;
		TeamDefault=1;
		AmbientLight=0;
		LOSModifier=16;

		Square, Random { Walkable=false; }
		{
			Item = stone;
			Times = 25+rand%25;
		}

                Square, Random { Walkable=true; }
		{
			Item = mine { Team = MONSTER_TEAM; Active = true; }
			Times = rand%4;
		}

		Square, Random { Walkable=true; }
		{
			Item = beartrap { Team = MONSTER_TEAM; Active = true; }
			Times = rand%4;
		}

		RoomDefault
		{
			Pos=2+rand%(XSize-6),2+rand%(YSize-6);
			Size=4+rand%8,4+rand%8;
			AltarPossible=true;
			WallSquare=solidterrain(GROUND),wall(BRICK_OLD);
			FloorSquare=solidterrain(PARQUET),empty;
			DoorSquare=solidterrain(PARQUET),door;
			GenerateDoor=true;
			ReCalculate=true;
                        DivineMaster=0;
                        GenerateTunnel=true;
			GenerateLanterns=true;
			Type=normalroom;
			GenerateFountains=true;
			AllowLockedDoors=true;
			AllowBoobyTrappedDoors=true;
		}
	}

	Level 0;
	{
		GenerateUpStairs=false;

		RoomDefault
		{
			AltarPossible=false;
		}

		Square, Random { Walkable=true; }
		{
			Character=spider;
			Times=20;
		}

		Square, Random { Walkable=true; }
		{
			Character=kobold;
			Times=10;
		}

		Room 0;
		{
			Size=5,5;
			AllowLockedDoors=false;
			AllowBoobyTrappedDoors=false;

			Square, Pos 2,2;
			{
				IsWorldMapEntry=true;
				OTerrain=stairsup;
			}

			Square, Pos 3,1;
			{
				Item=lantern;
			}
		}
	}

	Level 2+rand%2;
	{
		LevelMessage="You hear many wolves howling. You shiver.";
		Rooms=10+rand%21;

		Room 1;
		{
			Size=7,7;
			AltarPossible=false;

			CharacterMap
			{
				Pos=1,1;
				Size=5,5;

				Types
				{
					w=wolf;
					W=werewolfhuman;
				}
			}
			{
				wwwww
				wwwww
				wwWww
				wwwww
				wwwww
			}
		}
	}

	Level 2+rand%2;
	{
		Rooms=10+rand%21;

		Room 2;
		{
			Size=5,7;
			AltarPossible=false;
			DivineMaster=mellis;
			Type=shop;
			AllowLockedDoors=false;
			AllowBoobyTrappedDoors=false;
			GenerateFountains=false;

			Square, Pos 1,1;
			{
				Character=guard { Team=6; }
			}

			Square, Pos 3,1;
			{
				Character=guard { Team=6; }
			}

			Square, Pos 1,5;
			{
				Character=guard { Team=6; }
			}

			Square, Pos 3,5;
			{
				Character=guard { Team=6; }
			}

			Square, Pos 2,3;
			{
				Character=shopkeeper { Team=6; }
			}

			ItemMap
			{
				Pos=1,1;
				Size=3,5;

				Types
				{
					c = scrollofchangematerial;
					L = IRON IRON meleeweapon(LONGSWORD);
					C = MITHRIL bodyarmor(CHAINMAIL);
					s = wandofstriking;
					a = lantern;
                                        l = BREAD loaf;
					t = scrollofteleportation;
					g = IRON can { ContainedMaterial = GOBLINOIDFLESH; }
					p = IRON meleeweapon(POLEAXE);
					B = BEEF loaf;
				}
			}
			{
			    .B.
			    pag
			    t.c
			    LlC
			    .s.
			}
		}
	}

	Level 4;
	{
		LevelMessage="You hear a wailing scream in the distance. An Enner Beast must dwell in the level!";
		Rooms=10+rand%21;

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=ennerbeast { Team=4; }
		}
	}

	Level 5;
	{
		LevelMessage="You hear someone singing loudly: \"Uncle Lenin lives in Russia...\"";
		Rooms=10+rand%21;

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=communist { Team=7; }
		}
	}

	Level 6;
	{
		Description=DarkLevel;
		LevelMessage="You shudder as you sense a being of pure darkness nearby. Your goal is near.";
		FillSquare=solidterrain(FLOOR), IRON wall(BRICK_OLD);
		Items=0;
		GenerateDownStairs=false;

		RoomDefault
		{
			AltarPossible=false;
			WallSquare=solidterrain(FLOOR), IRON wall(BRICK_OLD);
			DoorSquare=solidterrain(PARQUET), IRON door;
			GenerateLanterns=false;
		}

		Square, Random { Walkable=true; InRoom=true; }
		{
			Character=elpuri;
		}
	}

	Level 5+rand%4;
	{
		Rooms=10+rand%21;

		Room 1;
		{
			Size=7,7;
			AltarPossible=false;

			CharacterMap
			{
				Pos=1,1;
				Size=5,5;

				Types
				{
					G=golem;
				}
			}
			{
				GGGGG
				GGGGG
				GGGGG
				GGGGG
				GGGGG
			}
		}
	}

	Level 8;
	{
		GenerateDownStairs=false;

		Room 0;
		{
			Size=7,7;
			AltarPossible=false;
			WallSquare=solidterrain(GROUND),IRON wall(BRICK_OLD);
			FloorSquare=solidterrain(PARQUET),empty;
			DoorSquare=solidterrain(PARQUET),IRON door;

			Square, Pos 3,3;
			{
				OTerrain=IRON stairsdown;
			}

			Square, Pos 3,5;
			{
				IsDownStairs=true;
			}
		}
	}

	Level 9;
	{
		Description=OreeLair;
		LevelMessage="\"Welcome to my lair, mortal! There's no escape now!\" Suddenly the stairs disappear.";
		FillSquare=solidterrain(FLOOR), IRON wall(BRICK_OLD);
		Rooms=1;
		GenerateMonsters=false;
		GenerateUpStairs=false;
		GenerateDownStairs=false;
		Items=0;
		ReCalculate=false;

		Room 0;
		{
			Size=7,7;
			AltarPossible=false;
			WallSquare=solidterrain(FLOOR), IRON wall(BRICK_OLD);
			FloorSquare=solidterrain(PARQUET),empty;
			GenerateDoor=false;
			ReCalculate=false;
			DivineMaster=mortifer;
			GenerateFountains=false;

			Square, Pos 3,1;
			{
				OTerrain = IRON altar(mortifer);
			}

			Square, Pos 3,3;
			{
				IsUpStairs=true;
			}

			Square, Pos 3,5;
			{
				OTerrain=IRON stairsup;
			}

			CharacterMap
			{
				Pos=1,1;
				Size=5,5;

				Types
				{
					O=oree;
					B=darkknight;
					G=BLOOD golem;
				}
			}
			{
				..O..
				.BBB.
				GB.BG
				.BBB.
				..G..
			}
		}
	}
}

Dungeon 1;
{
	Levels=1;

	Level 0;
	{
		Description=Attnam;
		FillSquare=solidterrain(GRASSTERRAIN),empty;

		Variable XSize = 61;
		Variable YSize = 62;

		Size=XSize, YSize;
		GenerateMonsters=false;
		Rooms=25 + rand % 6;
		Items=0;
		ReCalculate=false;
		GenerateUpStairs=false;
		GenerateDownStairs=false;
		OnGround=true;
		TeamDefault=2;
		AmbientLight=225;
		LOSModifier=48;

		RoomDefault
		{
			Pos=2+rand%(XSize-6),2+rand%(YSize-6);
			Size=4+rand%8,4+rand%8;
			AltarPossible=false;
			WallSquare=solidterrain(GRASSTERRAIN),wall(BRICK_FINE);
			FloorSquare=solidterrain(PARQUET),empty;
			DoorSquare=solidterrain(PARQUET),door;
			GenerateDoor=true;
			ReCalculate=true;
			DivineMaster=0;
			GenerateTunnel=false;
			GenerateLanterns=true;
			Type=normalroom;
			GenerateFountains=false;
			AllowLockedDoors=false;
			AllowBoobyTrappedDoors=false;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			OTerrain=decoration(PINE);
			Times=50;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			OTerrain=decoration(SPRUCE);
			Times=200;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=hunter;
			Times=10;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=polarbear;
			Times=5;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=farmer;
			Times=5;
		}

		Square, Random { Walkable=true; InRoom=false; }
		{
			Character=housewife;
			Times=5;
		}

		Square, Pos 30,61;
		{
			IsWorldMapEntry=true;
		}
	
		Room 0;
		{
			Pos=10,10;
			Size=41,42;
			AltarPossible=false;
			WallSquare=solidterrain(GRASSTERRAIN),MITHRIL wall(BRICK_FINE);
			FloorSquare=solidterrain(GRASSTERRAIN),empty;
			GenerateDoor=false;
			ReCalculate=false;
			DivineMaster=valpurus;
			GenerateLanterns=false;
			Type=cathedral;
			
			Square, Pos 19, 41;
			{
				OTerrain = empty;
			}

			Square, Pos 20, 41;
			{
				OTerrain = empty;
			}

			Square, Pos 21, 41;
			{
				OTerrain = empty;
			}
			
			GTerrainMap
			{
				Pos=4,4;
				Size=33,34;
				Types
				{
					# = MARBLE solidterrain(FLOOR);
					- = MARBLE solidterrain(FLOOR);
					~ = liquidterrain(POOL);
				}
			}
			{
				............#########............
				............#-------#............
				####......###-------###......####
				#--#......#-----------#......#--#
				#--#....###-----------###....#--#
				#--#....#---------------#....#--#
				#--###..#---------------#..###--#
				#----#..#---------------#..#----#
				#----#..#---------------#..#----#
				###--#..###-----------###..#--###
				..#--###..#-----------#..###--#..
				..#----#..#-----------#..#----#..
				..###--####-----------####--###..
				....#-----#-----------#-----#....
				....#-----#-----------#-----#....
				....####--#-----------#--####....
				.......#--#-----------#--#.......
				......###-#-----------#-###......
				..#####-#-#-----------#-#-#####..
				.##-------#-----------#-------##.
				.#---~~~#-#-----------#-#------#.
				.#---~~~#-#-----------#-#------#.
				.##--~~~#-#-----------#-#-----##.
				..##-~~~#-#-----------#-#----##..
				...##~~~#-######-######-#---##...
				....#~~~#---------------#---#....
				....#~~~#---------------#---#....
				...#######---###-###---#######...
				####---------#.....#---------####
				#--------#####.....#####--------#
				#--------#.............#--------#
				##---#####.............#####---##
				.##--#.....................#--##.
				..####.....................####..
			}

			OTerrainMap
			{
				Pos=1,1;
				Size=39,40;
				Types
				{
					# = VALPURIUM wall(BRICK_FINE);
					T = throne;
					c = decoration(CARPET);
					A = VALPURIUM altar(valpurus);
					D = VALPURIUM door;
					L = VALPURIUM door { Parameters = LOCKED; }
					b = decoration(LINDEN);
					1 = decoration(POOLCORNER) { VisualEffects = NONE; }
					2 = decoration(POOLCORNER) { VisualEffects = MIRROR; }
					3 = decoration(POOLCORNER) { VisualEffects = MIRROR | FLIP; }
					4 = decoration(POOLCORNER) { VisualEffects = FLIP; }
					5 = decoration(POOLBORDER) { VisualEffects = NONE; }
					6 = decoration(POOLBORDER) { VisualEffects = ROTATE; }
					7 = decoration(POOLBORDER) { VisualEffects = FLIP; }
					8 = decoration(POOLBORDER) { VisualEffects = MIRROR | ROTATE; }
					s = decoration(COUCH);
					f = fountain;
					d = decoration(DOUBLEBED);
				}
			}
			{
				b.b.b.b.b.b.b.b.b.b.b.b.b.b.b.b.b.b.b.b
				.......................................
				b...b...b..b...b.b.b.b.b...b..b...b...b
				..b...b........#########........b...b..
				b....b.......bb#.......#bb.......b....b
				...####b..b..###.......###..b..b####...
				b.b#..#.b....#...........#....b.#..#b.b
				...#..#....###...........###....#..#...
				b.b#..#b..b#.....T...T.....#b..b#..#b.b
				...#..###..#.......c.......#..###..#...
				b.b#....#.b#.......c.......#b.#....#b.b
				...#....#..#.......c.......#..#....#...
				b.b###..#b.###.....c.....###.b#..###b.b
				....b#..###.b#.....c.....#b.###..#b....
				b....#....#..#.....c.....#..#....#....b
				..bb.###..####.....c.....####..###.bb..
				b.....b#.....#.....c.....#.....#b.....b
				.b..b..#.....#.....c.....#.....#..b..b.
				b..b...####..#.....c.....#..####...b..b
				b....b....#..#.....c.....#..#....b....b
				.b.b....b###D#.....c.....#D###b....b.b.
				b...b#####.#.#.....c.....#.#.#####b.b.b
				....##.....D.#.....c.....#.D.....##....
				b..b#.s.152#.#.....c.....#.#......#b..b
				.b..#...8.6#.#.....c.....#.#..A...#..b.
				b...##..8.6#.#.....c.....#.#.....##...b
				....b##.8.6#.#...........#.#....##b....
				b.b..b##8.6#.######D######.#...##b..b.b
				.......#8.6#...............#...#.......
				b...b.b#473#...............#...#b.b...b
				.b....#######...###D###...#######....b.
				b..####.s.s.D...#.b.b.#...L.....####..b
				..b#.d......#####.....#####........#b..
				b..#....s.s.#b..b.....b..b#........#..b
				.b.##...#####.bb..b.b..bb.#####...##.b.
				b..b##s.#b.b......f.f......b.b#..##b..b
				....b####....b...........b....####b....
				b.b...b...b.......b.b.......b...b...b.b
				...............bb.....bb...............
				b.b.b.b.b.b.b.b..b...b..b.b.b.b.b.b.b.b
			}

			ItemMap
			{
				Pos=4,4;
				Size=33,34;
				Types
				{
					# = 0;
					a = avatarofvalpurus;
					b = banana;
					k = kiwi;
					p = pineapple;
					o = IRON meleeweapon(POLEAXE);
					l = MITHRIL MITHRIL meleeweapon(LONGSWORD);
					t = IRON IRON meleeweapon(TWOHANDEDSWORD);
					m = IRON meleeweapon(SPIKEDMACE);
					s = IRON meleeweapon(SPEAR);
					c = bodyarmor(CHAINMAIL);
					e = backpack;
					g = GOLD stone;
					i = SILVER stone;
					h = SAPPHIRE stone;
					r = RUBY stone;
					d = DIAMOND stone;
					C = chest;
					W = wandofpolymorph;
				}
			}
			{
				............#########............
				............#.......#............
				####......###.......###......####
				#..#......#...........#......#..#
				#..#....###...........###....#..#
				#..#....#...d.....a.d...#....#..#
				#..###..#......p.p......#..###..#
				#...e#..#......b.b......#..#....#
				#...e#..#......k.k......#..#....#
				###.e#..###.r..p.p..r.###..#..###
				..#.e###..#....b.b....#..###..#..
				..#....#..#....k.k....#..#....#..
				..###..####....p.p....####..###..
				....#.....#.h..b.b..h.#.....#....
				....#.....#....k.k....#.....#....
				....####..#....p.p....#..####....
				.......#..#....b.b....#..#.......
				......###.#.i..k.k..i.#.###......
				..#####.#.#....p.p....#.#.#####..
				.##.......#....b.b....#.......##.
				.#......#.#....k.k....#.#......#.
				.#......#.#.g..p.p..g.#.#......#.
				.##.....#.#....b.b....#.#.....##.
				..##....#.#...........#.#....##..
				...##...#.######.######.#...##...
				....#...#...............#...#....
				....#...#...............#...#....
				...#######...###.###...#######...
				####.........#.....#....ooool####
				#........#####.....#####.....ttc#
				#........#.............#ssss...c#
				##...#####.............#####mm.##
				.##..#.....................#mm##.
				..####.....................####..
			}

			CharacterMap
			{
				Pos=4,4;
				Size=33,34;
				Types
				{
					# = 0;
					P = petrus;
					c = guard;
					p = priest;
					d = dolphin;
					l = lightfrog;
					s = femaleslave;
					1 = petrusswife(1);
					2 = petrusswife(2);
					3 = petrusswife(3);
					4 = petrusswife(4);
					5 = petrusswife(5);
					6 = petrusswife(6);
					k = kamikazedwarf(valpurus);
				}
			}
			{
				............#########............
				............#c..c..c#............
				####......###.......###......####
				#k.#......#c....l....c#......#..#
				#k.#....###...........###....#..#
				#k.#....#c...sPs.s.s...c#....#..#
				#k.###..#...............#..###..#
				#k...#..#..l....l....l..#..#....#
				#k...#..#c.............c#..#....#
				###..#..###...........###..#..###
				..#..###..#...........#..###..#..
				..#....#..#c.l.....l.c#..#....#..
				..###k.####...........####..###..
				....#k...k#...........#.....#....
				....#k...k#...........#.....#....
				....####.k#c.........c#..####....
				.......#..#...........#..#.......
				......###.#...........#.###......
				..#####c#.#...........#.#.#####..
				.##.......#c.........c#.......##.
				.#......#.#...........#.#..p...#.
				.#....d.#.#...........#.#......#.
				.##...d.#.#...........#.#.....##.
				..##.d.d#.#c.........c#.#....##..
				...##.d.#.######.######.#...##...
				....#.d.#......c.c......#...#....
				....#...#...............#...#....
				...#######...###.###..c#######...
				####.3.5.....#c...c#..c......####
				#.1......#####.....#####........#
				#....4.6.#.............#........#
				##...#####.............#####...##
				.##2.#.....................#..##.
				..####.....................####..
			}
		}

		Room 1;
		{
			Pos=32,54;
			Size=7,5;
			AltarPossible=false;
			WallSquare=solidterrain(GRASSTERRAIN),wall(BRICK_FINE);
			FloorSquare=solidterrain(PARQUET),empty;
			GenerateDoor=false;
			ReCalculate=false;
			DivineMaster=mellis;
			Type=shop;
			
			Square, Pos 3, 4;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = door;
			}

			Square, Pos 1, 1;
			{
				Character = slave;
			}

			Square, Pos 5, 1;
			{
				Character = shopkeeper;
			}

			ItemMap
			{
				Pos=1,1;
				Size=5,3;
				Types
				{
					t = scrollofteleportation;
					s = meleeweapon(SPEAR);
					p = pickaxe;
					A = potion { ContainedMaterial = HEALINGLIQUID; }
					b = banana;
					l = WOLFFLESH lump;
					i = can { ContainedMaterial = POLARBEARFLESH; }
					L = BREAD loaf;
					a = lantern;
					P = potion { ContainedMaterial = OMLEURINE; }
					C = bodyarmor(CHAINMAIL);
					w = whip;
				}
			}
			{
			    .spw.
			    bLlCP
			    tiAat
			}
		}

		Room 2;
		{
			Pos=54,55;
			Size=5,5;
			WallSquare=solidterrain(GRASSTERRAIN),GOLD wall(BRICK_FINE);
			GenerateDoor=false;
			DivineMaster=legifer;
			Type=temple;

			Square, Pos 2, 0;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = GOLD door;
			}

			Square, Pos 2, 2;
			{
				OTerrain = GOLD altar(legifer);
			}

			Square, Pos 2, 3;
			{
				Character = priest;
			}
		}

		Room 3;
		{
			Pos=2,55;
			Size=5,5;
			WallSquare=solidterrain(GRASSTERRAIN),MARBLE wall(BRICK_FINE);
			GenerateDoor=false;
			DivineMaster=dulcis;
			Type=temple;

			Square, Pos 4, 2;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = MARBLE door;
			}

			Square, Pos 2, 2;
			{
				OTerrain = MARBLE altar(dulcis);
			}

			Square, Pos 1, 2;
			{
				Character = priest;
			}
		}

		Room 4;
		{
			Pos=54,2;
			Size=5,5;
			WallSquare=solidterrain(GRASSTERRAIN),BANANAFLESH wall(BRICK_FINE);
			GenerateDoor=false;
			DivineMaster=seges;
			Type=temple;

			Square, Pos 0, 2;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = BANANAFLESH door;
			}

			Square, Pos 2, 2;
			{
				OTerrain = BANANAFLESH altar(seges);
			}

			Square, Pos 3, 2;
			{
				Character = priest;
			}
		}

		Room 5;
		{
			Pos=2,2;
			Size=5,5;
			WallSquare=solidterrain(GRASSTERRAIN),PARCHMENT wall(BRICK_FINE);
			GenerateDoor=false;
			DivineMaster=sophos;
			Type=temple;

			Square, Pos 2, 4;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = PARCHMENT door;
			}

			Square, Pos 2, 2;
			{
				OTerrain = PARCHMENT altar(sophos);
			}

			Square, Pos 2, 1;
			{
				Character = priest;
			}
		}

		Room 6;
		{
			Pos=22,54;
			Size=7,5;
			AltarPossible=false;
			WallSquare=solidterrain(GRASSTERRAIN),wall(BRICK_FINE);
			FloorSquare=solidterrain(PARQUET),empty;
			GenerateDoor=false;
			ReCalculate=false;
			DivineMaster=sophos;
			Type=library;
			
			Square, Pos 3, 4;
			{
				GTerrain = solidterrain(PARQUET);
				OTerrain = door;
			}


			Square, Pos 3, 2;
			{
				Character = librarian;
			}

			ItemMap
			{
				Pos=1,1;
				Size=5,3;
				Types
				{
					t = scrollofteleportation;
					c = scrollofcreatemonster;
					C = scrollofcharging;
					h = holybook;
				}
			}
			{
			    Chhhh
			    c...h
			    t...h
			}

			OTerrainMap
			{
				Pos=1,1;
				Size=5,3;
				Types
				{
					= = container(BOOKCASE);
				}
			}
			{
				=====
				=...=
				=...=
			}
		}

		Room 7;
		{
			FloorSquare=solidterrain(FLOOR),empty;
			WallSquare=solidterrain(GRASSTERRAIN), WOOD wall(BRICK_FINE);
			DoorSquare=solidterrain(FLOOR), door;
		}

		Room 8;
		{
			FloorSquare=solidterrain(FLOOR),empty;
			WallSquare=solidterrain(GRASSTERRAIN), WOOD wall(BRICK_FINE);
			DoorSquare=solidterrain(FLOOR), door;
		}

		Room 9;
		{
			FloorSquare=solidterrain(FLOOR),empty;
			WallSquare=solidterrain(GRASSTERRAIN), WOOD wall(BRICK_FINE);
			DoorSquare=solidterrain(FLOOR), door;
		}
	}
}

